@page "/trainLetter"

@inject ApiConnection _apiCall

<PageTitle>Sök efter en station att åka från</PageTitle>

<div class="behind">
    <div class="search">
        <input type="text"
        placeholder="Skriv för att söka station"
        @bind-value="station"
        @bind-value:event="oninput"
        @onkeyup="FindStations"
        />
    </div>
    <div class="searchResultLayout">
    @if (foundStations is null)
    {
        <p class="emptySearchResult">Inga resultat...</p>
    }
    else
    {
        // Ansvers limited to 10 in the API call in ApiConnection
        foreach (var found in foundStations)
        {
            <a class="searchResult" href="/ChosenStation/@found.LocationSignature">@found.AdvertisedLocationName</a>
        }
    }
    </div>
</div>

@code {
    private List<JsonStationObject.Trainstation> foundStations;
    private string station = "";

    private async void FindStations()
    {
        if(station.Count() > 0)
        {
            foundStations = await _apiCall.GetStationsAsync(station);
        }   
    }
}
